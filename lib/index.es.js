function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function e(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,u=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var t=r.next();return u=t.done,t},e:function(t){l=!0,a=t},f:function(){try{u||null==r.return||r.return()}finally{if(l)throw a}}}}function n(t){var e={exports:{}};return t(e,e.exports),e.exports}var r=n((function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)})),o=n((function(t){var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)})),i=function(t,e,n){if(function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!")}(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},a=function(t){return"object"==typeof t?null!==t:"function"==typeof t},u=function(t){if(!a(t))throw TypeError(t+" is not an object!");return t},l=function(t){try{return!!t()}catch(t){return!0}},c=!l((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),f=r.document,d=a(f)&&a(f.createElement),p=!c&&!l((function(){return 7!=Object.defineProperty((t="div",d?f.createElement(t):{}),"a",{get:function(){return 7}}).a;var t})),s=Object.defineProperty,y={f:c?Object.defineProperty:function(t,e,n){if(u(t),e=function(t,e){if(!a(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!a(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!a(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!a(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}(e,!0),u(n),p)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},v=c?function(t,e,n){return y.f(t,e,function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}(1,n))}:function(t,e,n){return t[e]=n,t},m={}.hasOwnProperty,h=function(t,e){return m.call(t,e)},w=function(t,e,n){var a,u,l,c=t&w.F,f=t&w.G,d=t&w.S,p=t&w.P,s=t&w.B,y=t&w.W,m=f?o:o[e]||(o[e]={}),b=m.prototype,g=f?r:d?r[e]:(r[e]||{}).prototype;for(a in f&&(n=e),n)(u=!c&&g&&void 0!==g[a])&&h(m,a)||(l=u?g[a]:n[a],m[a]=f&&"function"!=typeof g[a]?n[a]:s&&u?i(l,r):y&&g[a]==l?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(l):p&&"function"==typeof l?i(Function.call,l):l,p&&((m.virtual||(m.virtual={}))[a]=l,t&w.R&&b&&!b[a]&&v(b,a,l)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128;var b=w,g="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",x="["+g+"]",S=RegExp("^"+x+x+"*"),O=RegExp(x+x+"*$"),j=function(t,e,n){var r={},o=l((function(){return!!g[t]()||"​"!="​"[t]()})),i=r[t]=o?e(E):g[t];n&&(r[n]=i),b(b.P+b.F*o,"String",r)},E=j.trim=function(t,e){return t=String(function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}(t)),1&e&&(t=t.replace(S,"")),2&e&&(t=t.replace(O,"")),t},k=j,T=r.parseInt,M=k.trim,$=/^[-+]?0[xX]/,F=8!==T(g+"08")||22!==T(g+"0x16")?function(t,e){var n=M(String(t),3);return T(n,e>>>0||($.test(n)?16:10))}:T;b(b.G+b.F*(parseInt!=F),{parseInt:F});var I=o.parseInt;let P,_;const A=(t,e,n)=>{let r=typeof t!==e;return r&&console.error(`${n} 只支持object，当前是 ${typeof t}!`),r},C=()=>{_&&_.disconnect(),P&&P.remove()},R=(t,n={},r="main",o={})=>{if(A(n,"object","canvasOpt"))return;if(A(o,"object","warStyle"))return;if(C(),!t)return;let i=t=>document.getElementById(t),a=document.body.clientWidth||document.body.offsetWidth,u=I(a,10),l=u/I(u/200),c=window.getComputedStyle(document.body)["font-family"],f=document.createElement("canvas");f.width=(null==n?void 0:n.width)||l,f.height=(null==n?void 0:n.height)||150;let d=f.getContext("2d");d.font=`${(null==n?void 0:n.fontSize)||"16px"} ${(null==n?void 0:n.fontFamily)||c}`,d.fillStyle=(null==n?void 0:n.fillStyle)||"rgba(8, 8, 8, 0.08)",d.rotate((null==n?void 0:n.rotate)||-.29),d.fillText(t,(null==n?void 0:n.fillX)||0,(null==n?void 0:n.fillY)||80);const p=f.toDataURL("image/webp"),s=0===p.indexOf("data:image/webp");let y=p;null!=n&&n.imgType&&(y=f.toDataURL(null==n?void 0:n.imgType)),s||(y=f.toDataURL("image/png"));const v=document.createDocumentFragment();P=document.createElement("div"),P.id="water-mark",P.style.cssText+=`\n        ;width: 100%;\n        height: 100%;\n        top:0;\n        left:0;\n        position: fixed;\n        overflow: hidden;\n        z-index: 9999;\n        pointer-events: none;\n        background-repeat: repeat, repeat;\n        background-position: ${f.width/1.5}px ${f.height/1.4}px;\n        background-image: url("${y}");\n  `;for(let t in o)P.style[t]=o[t];let m=i(r);v.appendChild(P),i(P.id)||(m?m.appendChild(v):console.error("水印加载失败"));const h=e=>{e.remove(),R(t,n,r,o)};let w=i("water-mark");let b=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;return _=new b((t=>{var n,r=e(t);try{for(r.s();!(n=r.n()).done;){let t=n.value;if("water-mark"===t.oldValue||"water-mark"===t.target.id){h(w);break}var o,i=e(t.removedNodes);try{for(i.s();!(o=i.n()).done;){if("water-mark"===o.value.id){h(w);break}}}catch(t){i.e(t)}finally{i.f()}}}catch(t){r.e(t)}finally{r.f()}})),_.observe(m,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),C};export default R;
